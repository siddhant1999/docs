---
title: "Webhooks"
description: "Set up webhooks to receive real-time notifications about order events"
---

## Overview

Webhooks allow your application to receive real-time notifications when events occur in Phoenix. When an order is created or its status changes, Phoenix can automatically send an HTTP POST request to your specified webhook endpoints.

## Getting Started

### 1. Obtain Webhook API Key

Before setting up webhooks, you need to obtain a webhook API key from Phoenix:

1. Contact our support team at [main@phoenix.market](mailto:main@phoenix.market)
2. Request webhook access for your integration
3. You'll receive a `webhook_secret` that will be used for webhook authentication
4. This key will be sent in the `Authorization` header as `Bearer <webhook_secret>`

### 2. Configure Your Webhook Endpoints

Your webhook endpoints should:
- Accept POST requests
- Return a `200` status code to acknowledge receipt
- Process the webhook payload within 30 seconds
- Validate the `Authorization` header
- Handle duplicate events gracefully (use `orderId` for idempotency)

## Querying Orders

You can query order details at any time using the Phoenix API. This is useful for getting the complete order information or checking the current status.

<Note>
You can use this endpoint to test your connection to the Phoenix service before setting up webhooks.
</Note>

### Endpoint
```
GET https://prod-phoenix-api-kwr2.encr.app/orders/:orderId
```

### Example Request
```javascript
const orderId = "15LNf2PSt6G77W2iuL8MMb";
const response = await fetch(`https://prod-phoenix-api-kwr2.encr.app/orders/${orderId}`);
const orderData = await response.json();
```

### Example Response

<Accordion title="View Example Response">
```json
{
  "id": "15LNf2PSt6G77W2iuL8MMb",
  "autofill": true,
  "createdAt": "2025-05-28T22:52:18.751Z",
  "inputAmount": "10.1",
  "minimumAmountOut": "10100000",
  "uniquenessAmount": "0",
  "verificationMethod": "teller-zelle-payment-verified-by-seller",
  "orderStatus": {
    "status": "fulfilled",
    "updatedAt": "2025-05-28T22:54:32.459Z"
  },
  "orderFulfillment": {
    "createdAt": "2025-05-28T22:54:32.459Z",
    "transaction": {
      "hash": "0xba9af64850b7817d4d9d6f4f73045bf365946e03ab2fc493d5cd766671469f98"
    }
  }
}
```
</Accordion>

## Order Status Update Webhook

### Endpoint Configuration
**Endpoint**: `/phoenix-order-status-updated`
**Event Type**: `order.status.change`
**Triggered**: When an order's status changes

### Common Status Values
- `fulfilled` - Order has been completed successfully
- `expired` - Order expired before completion
- `pending` - Order is awaiting processing

### Implementation Example

```javascript
app.post('/phoenix-order-status-updated', (req, res) => {
  const { event, id, timestamp, data } = req.body;
  const { order, orderId, orderStatus } = data;
  
  // Validate required fields
  if (!event || !data || !data.orderId || !data.orderStatus) {
    return res.status(400).json({
      error: 'Missing required fields',
      required: ['event', 'data.orderId', 'data.orderStatus']
    });
  }
  
  // Validate authorization header
  const authHeader = req.headers.authorization;
  if (!authHeader || !authHeader.startsWith('Bearer ')) {
    return res.status(401).json({
      error: 'Missing or invalid authorization header'
    });
  }
  
  // Process the status update
  console.log(`Order ${data.orderId} status changed to: ${data.orderStatus}`);
  // Add your business logic here
  
  res.json({
    success: true,
    message: 'Order status webhook received',
    orderId: data.orderId,
    orderStatus: data.orderStatus
  });
});
```

### Payload Structure

<Accordion title="View Payload Structure">
```json
{
  "event": "order.status.change",
  "id": "evt_1750886808355_km9bcr5qc",
  "timestamp": "2025-05-28 22:52:18.751",
  "data": {
    "order": {
      "id": "15LNf2PSt6G77W2iuL8MMb",
      "inputAmount": "10.1",
      "minimumAmountOut": "10100000",
      "verificationMethod": "teller-zelle-payment-verified-by-seller",
      "createdAt": "2025-05-28T22:52:18.751Z",
      "orderStatus": {
        "status": "fulfilled",
        "updatedAt": "2025-05-28T22:54:32.459Z"
      },
      "orderFulfillment": {
        "transaction": {
          "hash": "0xba9af64850b7817d4d9d6f4f73045bf365946e03ab2fc493d5cd766671469f98"
        },
        "createdAt": "2025-05-28T22:54:32.459Z"
      }
    },
    "orderId": "15LNf2PSt6G77W2iuL8MMb",
    "orderStatus": "fulfilled",
    "timestamp": "2025-05-28 22:52:18.751"
  }
}
```
</Accordion>

## Authentication

Phoenix uses Bearer token authentication for webhooks:

- **Header**: `Authorization: Bearer <webhook_secret>`
- **Webhook Secret**: Provided by Phoenix support team
- **Validation**: Always verify the authorization header exists and contains a valid Bearer token

<Accordion title="View Authentication Code Example">
```javascript
// Authentication validation example
const authHeader = req.headers.authorization;
if (!authHeader || !authHeader.startsWith('Bearer ')) {
  return res.status(401).json({
    error: 'Missing or invalid authorization header',
    expected: 'Bearer <webhook_secret>'
  });
}

const webhookSecret = authHeader.replace('Bearer ', '');
// Verify this matches your provided webhook secret
```
</Accordion>

## Best Practices

1. **Validate Authentication**: Always check the `Authorization` header
2. **Validate Required Fields**: Ensure all required fields are present
3. **Implement Idempotency**: Use `orderId` to handle duplicate events
4. **Respond Quickly**: Process webhooks within 30 seconds
5. **Log Events**: Keep logs for debugging and monitoring
6. **Use HTTPS**: Only accept webhooks over secure HTTPS connections
7. **Handle Errors Gracefully**: Return appropriate HTTP status codes

## Support

For webhook-related questions or to request webhook access:
- **Email**: [main@phoenix.market](mailto:main@phoenix.market)